<!DOCTYPE html>
<html dir="ltr" lang="en" class="mercury dark">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=5.0"
    />
    <title>Tree View | Gemini</title>

    <script type="module" src="/build/gemini.esm.js"></script>
    <script nomodule src="/build/gemini.js"></script>
    <link href="/build/gemini.css" rel="stylesheet" />
    <link rel="stylesheet" href="../assets/styles.css" />
    <script src="../assets/scripts.js"></script>
    <style>
      * {
        box-sizing: border-box;
      }

      body {
        display: grid;
        grid-template-columns: 1fr 400px;
        margin: 0;
        min-height: 100vh;
      }

      fieldset {
        display: grid;
        grid-auto-flow: row;
        grid-auto-rows: max-content;
        gap: 8px;
        border: unset;
        padding: unset;
      }

      fieldset > div {
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
      }

      .flex-container {
        display: flex;
        gap: 8px;
      }

      .scroll-context {
        display: grid;
        block-size: 100%;
        overflow: auto;
        position: relative;
      }

      .absolute-content {
        display: grid;
        position: absolute;
        inset: 0;
      }

      .main-container {
        display: grid;
        grid-template-rows: 1fr min-content;
        align-self: stretch;
        width: 100%;
        padding-inline: 4px;
        gap: 8px;
        margin: 16px;
      }

      .section-dev {
        display: grid;
        grid-template-columns: 400px 1fr;
        margin-inline-start: 300px;
        gap: 32px;
        height: 100%;
      }

      .scroll {
        overflow-y: auto;
        height: 100%;
      }
    </style>
  </head>
  <body>
    <div class="card">
      <h1>gxg-tree-view</h1>

      <div class="section-dev">
        <gxg-tree-view show-lines="all" multi-selection="true"></gxg-tree-view>

        <div class="scroll-context">
          <div class="absolute-content">
            <ch-textblock id="contextmenu-textblock"
              >+ + + + + + + Context + + + + + + +</ch-textblock
            >

            <ch-textblock id="open-reference-textblock"
              ><br />+ + + + + Open Reference + + + + +</ch-textblock
            >

            <ch-textblock id="selected-items-textblock"
              ><br />+ + + + + Selected Items + + + + +</ch-textblock
            >

            <ch-textblock id="checked-items-textblock"
              ><br />+ + + + + Checked items + + + + +<br /><br />+ + + + +
              Unchecked items + + + + +</ch-textblock
            >
          </div>
        </div>
      </div>
    </div>

    <div class="card card-properties">
      <fieldset>
        <legend class="form-input__label">Properties</legend>

        <div>
          <ch-checkbox
            id="multi-selection"
            checked-value="true"
            un-checked-value="false"
            value="true"
            caption="Multi selection"
          ></ch-checkbox>

          <ch-checkbox
            id="editable"
            checked-value="true"
            un-checked-value="false"
            value="true"
            caption="Editable Items"
          ></ch-checkbox>

          <ch-checkbox
            id="expand-on-click"
            checked-value="true"
            un-checked-value="false"
            value="true"
            caption="Expand on click"
          ></ch-checkbox>
        </div>

        <div>
          <ch-checkbox
            id="drag-enabled"
            checked-value="true"
            un-checked-value="false"
            value="true"
            caption="Drag Enabled"
          ></ch-checkbox>

          <ch-checkbox
            id="drop-enabled"
            checked-value="true"
            un-checked-value="false"
            value="true"
            caption="Drop Enabled"
          ></ch-checkbox>
        </div>

        <div>
          <label
            class="form-input__label"
            style="display: flex; flex-direction: column"
          >
            Lines
            <select class="form-input" name="lines" id="lines">
              <option value="all" selected>All lines</option>
              <option value="last">Last line</option>
              <option value="none">None</option>
            </select>
          </label>

          <label
            class="form-input__label"
            style="display: flex; flex-direction: column"
          >
            Expandable button
            <select
              class="form-input"
              name="expandable-button"
              id="expandable-button"
            >
              <option value="action">Action</option>
              <option value="decorative" selected>Decorative</option>
              <option value="no">None</option>
            </select>
          </label>

          <label
            class="form-input__label"
            style="display: flex; flex-direction: column"
          >
            Drop mode
            <select class="form-input" name="drop-mode" id="drop-mode">
              <option value="above" selected>Above</option>
              <option value="before-after">Before and After</option>
              <option value="all">All</option>
            </select>
          </label>
        </div>
      </fieldset>

      <hr />

      <fieldset>
        <legend class="form-input__label">Methods</legend>

        <div>
          <button class="button-primary" id="expand-all" type="button">
            Expand All
          </button>
          <button class="button-primary" id="collapse-all" type="button">
            Collapse All
          </button>

          <ch-checkbox
            id="check-all"
            checked-value="true"
            un-checked-value="false"
            value="false"
            caption="Check / uncheck all"
          ></ch-checkbox>
        </div>

        <fieldset style="grid-template-columns: max-content max-content">
          <legend class="form-input__label">Update items properties</legend>

          <div class="flex-container" style="flex-direction: column">
            <ch-checkbox
              id="update-items-properties-selected"
              checked-value="true"
              un-checked-value="false"
              value="false"
              caption="Selected"
            ></ch-checkbox>

            <ch-checkbox
              id="update-items-properties-checked"
              checked-value="true"
              un-checked-value="false"
              value="false"
              caption="Checked"
            ></ch-checkbox>
          </div>

          <div class="flex-container">
            <input
              class="form-input"
              aria-label="Items to update"
              id="items-to-update"
              placeholder="ItemId1,ItemId2,ItemId3"
              type="text"
            />
            <button class="button-primary" id="button-items-to-update">
              Update items
            </button>
          </div>
        </fieldset>

        <fieldset style="grid-template-columns: max-content max-content">
          <legend class="form-input__label">Scroll into visible</legend>

          <div class="flex-container" style="flex-direction: column">
            <ch-checkbox
              id="scroll-into-visible-selected"
              checked-value="true"
              un-checked-value="false"
              value="false"
              caption="Selected"
            ></ch-checkbox>

            <ch-checkbox
              id="scroll-into-visible-checked"
              checked-value="true"
              un-checked-value="false"
              value="false"
              caption="Checked"
            ></ch-checkbox>
          </div>

          <div class="flex-container">
            <input
              class="form-input"
              id="input-scroll-into-visible"
              type="text"
            />
            <button
              class="button-primary"
              id="btn-scroll-into-visible"
              type="button"
            >
              Scroll into visible
            </button>
          </div>
        </fieldset>

        <div class="flex-container">
          <input
            class="form-input"
            aria-label="Reload items"
            id="item-id-to-reload"
            placeholder="ItemId1"
            type="text"
          />
          <button class="button-primary" id="button-to-reload-items">
            Reload items
          </button>
        </div>

        <div class="flex-container">
          <input
            class="form-input"
            aria-label="Remove items"
            id="items-to-remove"
            placeholder="ItemId1,ItemId2,ItemId3"
            type="text"
          />
          <button class="button-primary" id="button-items-to-remove">
            Remove items
          </button>
        </div>
      </fieldset>

      <hr />

      <fieldset>
        <legend class="form-input__label">Filters</legend>

        <label class="form-input__label">
          Filter type
          <select class="form-input" name="filter-type" id="filter-type">
            <option value="checked">Checked</option>
            <option value="unchecked">Unchecked</option>
            <option value="caption">Caption</option>
            <option value="metadata">Metadata</option>
            <option value="id-list">List of ids</option>
            <option value="none" selected>None</option>
          </select>
        </label>

        <label class="form-input__label">
          Filter
          <input class="form-input" id="filter" value="" />
        </label>

        <div>
          <ch-checkbox
            id="camel-case"
            checked-value="true"
            un-checked-value="false"
            value="false"
            caption="Apply camel casing"
          ></ch-checkbox>

          <ch-checkbox
            id="hide-matches"
            checked-value="true"
            un-checked-value="false"
            value="false"
            caption="Hide matches and show non-matches"
          ></ch-checkbox>
        </div>
      </fieldset>

      <fieldset>
        <legend class="form-input__label">Models</legend>

        <div>
          <button class="button-primary" id="update-file-system-btn">
            File system
          </button>

          <button class="button-primary" id="kb-explorer-model-btn">
            KB Explorer
          </button>
          <button class="button-primary" id="import-objects-model-btn">
            Import Objects
          </button>
        </div>

        <div>
          <button class="button-primary" id="load-model-btn">
            Simple model 1
          </button>
          <button class="button-primary" id="update-model-again-btn">
            Simple model 2
          </button>

          <button class="button-primary" id="update-big-model-btn">
            Large model
          </button>

          <button class="button-primary" id="update-model-btn">
            Disabled items
          </button>
        </div>
      </fieldset>
    </div>

    <script type="module">
      import {
        fileSystemModel,
        lazyLoadItemsDictionary,
        kbExplorerModel,
        importObjectsModel
      } from "../assets/tree.js";

      const modelTiny = [
        {
          id: "number-1",
          caption: "number-1 label (always editable)",
          startImgSrc: "knowledge-base",
          editable: true
        },
        {
          id: "number-2",
          caption: "number-2 (always editable)",
          startImgSrc: "./objects/datastore",
          editable: true,
          items: [
            {
              id: "number-2.1",
              caption: "number-2.1",
              startImgSrc: "./objects/file"
            }
          ]
        },
        {
          id: "number-3",
          caption: "number-3",
          startImgSrc: "objects/patterns",
          items: [
            {
              id: "number-3.1",
              caption: "number-3.1",
              startImgSrc: "objects/java"
            }
          ]
        }
      ];

      const modelTinyUpdated = [
        {
          id: "number-1",
          caption: "number-1",
          startImgSrc: ".objects/csharp"
        },
        {
          id: "number-2",
          caption: "number-2",
          startImgSrc: "./objects/datastore",
          items: [
            {
              id: "number-2.1",
              caption: "number-2.1",
              startImgSrc: "objects/patterns",
              items: [
                {
                  id: "number-2.1.1",
                  caption: "number-2.1.1",
                  startImgSrc: "objects/java"
                }
              ]
            }
          ]
        },
        {
          id: "number-3",
          caption: "number-3",
          startImgSrc: "./objects/datastore",
          items: [
            {
              id: "number-3.1",
              caption: "number-3.1",
              startImgSrc: "./objects/datastore"
            }
          ]
        }
      ];

      const modelTinyUpdatedAgain = [
        {
          id: "number-a",
          caption: "number-a (always editable)",
          leaf: true,
          startImgSrc: "./objects/apple",
          editable: true
        },
        {
          id: "number-b",
          caption: "number-b",
          leaf: false,
          startImgSrc: "./objects/file",
          items: [
            {
              id: "number-2.1",
              caption: "number-2.1",
              leaf: false,
              startImgSrc: "objects/patterns",
              items: [
                {
                  id: "number-2.1.1",
                  caption: "number-2.1.1",
                  leaf: false,
                  startImgSrc: "objects/java",
                  items: [
                    {
                      id: "number-2.1.1.1",
                      caption: "number-2.1.1.1",
                      leaf: true,
                      startImgSrc: "/build/tree-item-assets/download"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          id: "number-3",
          caption: "number-3",
          leaf: true,
          startImgSrc: "objects/patterns"
        }
      ];

      const model = [
        {
          id: "number-1",
          caption: "number-1 label (always editable)",
          class: "tree-view-item tree-view-item--success",
          leaf: false,
          startImgSrc: "./objects/datastore",
          editable: true,
          items: [
            {
              id: "number-1-1",
              caption: "number-1-1 (always editable)",
              leaf: false,
              startImgSrc: "objects/patterns",
              editable: true,
              items: [
                {
                  id: "number-1-1-1",
                  caption: "number-1-1-1",
                  leaf: true,
                  startImgSrc: "knowledge-base"
                },
                {
                  id: "number-1-1-2",
                  caption: "number-1-1-2",
                  leaf: false,
                  startImgSrc: "knowledge-base",
                  items: [
                    {
                      id: "number-1-1-2-1",
                      caption: "number-1-1-2-1 (lazy, drag disabled)",
                      leaf: false,
                      startImgSrc: "knowledge-base",
                      lazy: true,
                      checkbox: true,
                      dragDisabled: true,
                      toggleCheckboxes: true
                    },
                    {
                      id: "number-1-1-2-2",
                      caption: "number-1-1-2-2",
                      leaf: true,
                      startImgSrc: "objects/java"
                    }
                  ]
                }
              ]
            },
            {
              id: "number-1-2",
              caption: "number-1-2",
              leaf: true,
              startImgSrc: "knowledge-base"
            }
          ]
        },
        {
          id: "number-2",
          caption: "number-2",
          class: "tree-view-item tree-view-item--custom-image",
          leaf: false,
          items: [
            {
              id: "number-2-1",
              caption: "number-2-1",
              leaf: true,
              startImgSrc: "objects/java"
            },
            {
              id: "number-2-2",
              caption: "number-2-2",
              leaf: true,
              startImgSrc: "knowledge-base"
            }
          ]
        }
      ];

      const updatedModel = [
        {
          id: "number-1",
          caption: "number-1",
          leaf: false,
          startImgSrc: "knowledge-base",
          items: [
            {
              id: "number-1-1",
              caption: "number-1-1",
              class: "ch-tree-view-item--success",
              leaf: false,
              startImgSrc: "knowledge-base",
              items: [
                {
                  id: "number-1-1-1",
                  caption: "number-1-1-1",
                  leaf: true,
                  startImgSrc: "knowledge-base"
                },
                {
                  id: "number-1-1-2",
                  caption: "number-1-1-2",
                  leaf: false,
                  startImgSrc: "knowledge-base",
                  items: [
                    {
                      id: "number-1-1-2-1",
                      caption: "number-1-1-2-1",
                      leaf: false,
                      startImgSrc: "knowledge-base",
                      items: [
                        {
                          id: "new-item-added-1",
                          caption: "new-item-added-1",
                          disabled: true,
                          leaf: true,
                          startImgSrc: "knowledge-base"
                        },
                        {
                          id: "new-item-added-2",
                          caption: "new-item-added-2",
                          disabled: false,
                          leaf: true,
                          startImgSrc: "knowledge-base"
                        },
                        {
                          id: "new-item-added-3",
                          caption: "new-item-added-3",
                          disabled: true,
                          leaf: true,
                          startImgSrc: "knowledge-base"
                        },
                        {
                          id: "new-item-added-4",
                          caption: "new-item-added-4",
                          disabled: false,
                          expanded: true,
                          leaf: false,
                          startImgSrc: "knowledge-base",
                          items: [
                            {
                              id: "new-item-added-4-1",
                              caption: "new-item-added-4-1",
                              disabled: false,
                              leaf: true,
                              startImgSrc: "knowledge-base"
                            },
                            {
                              id: "new-item-added-4-2",
                              caption: "new-item-added-4-2",
                              disabled: true,
                              expanded: true,
                              leaf: false,
                              startImgSrc: "knowledge-base",
                              items: [
                                {
                                  id: "new-item-added-4-2-1",
                                  caption: "new-item-added-4-2-1",
                                  disabled: true,
                                  expanded: true,
                                  leaf: false,
                                  startImgSrc: "knowledge-base",
                                  items: [
                                    {
                                      id: "new-item-added-4-2-1-1",
                                      caption: "new-item-added-4-2-1-1",
                                      disabled: false,
                                      leaf: true,
                                      startImgSrc: "knowledge-base"
                                    },
                                    {
                                      id: "new-item-added-4-2-1-2",
                                      caption: "new-item-added-4-2-1-2",
                                      disabled: false,
                                      leaf: true,
                                      startImgSrc: "knowledge-base"
                                    },
                                    {
                                      id: "new-item-added-4-2-1-3",
                                      caption: "new-item-added-4-2-1-3",
                                      disabled: true,
                                      leaf: true,
                                      startImgSrc: "knowledge-base"
                                    },
                                    {
                                      id: "new-item-added-4-2-1-4",
                                      caption: "new-item-added-4-2-1-4",
                                      disabled: false,
                                      leaf: true,
                                      startImgSrc: "knowledge-base"
                                    }
                                  ]
                                },
                                {
                                  id: "new-item-added-4-2-2",
                                  caption: "new-item-added-4-2-2",
                                  disabled: true,
                                  leaf: true,
                                  startImgSrc: "knowledge-base"
                                }
                              ]
                            }
                          ]
                        },
                        {
                          id: "new-item-added-5",
                          caption: "new-item-added-5",
                          disabled: true,
                          expanded: true,
                          leaf: false,
                          startImgSrc: "knowledge-base",
                          items: [
                            {
                              id: "new-item-added-5-1",
                              caption: "new-item-added-5-1",
                              disabled: false,
                              leaf: true,
                              startImgSrc: "knowledge-base"
                            },
                            {
                              id: "new-item-added-5-2",
                              caption: "new-item-added-5-2",
                              disabled: true,
                              leaf: true,
                              startImgSrc: "knowledge-base"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      id: "number-1-1-2-2",
                      caption: "number-1-1-2-2",
                      leaf: true,
                      startImgSrc: "knowledge-base"
                    }
                  ]
                }
              ]
            },
            {
              id: "number-1-2",
              caption: "number-1-2",
              leaf: true,
              startImgSrc: "knowledge-base"
            }
          ]
        },
        {
          id: "number-2",
          caption: "number-2",
          leaf: false,
          startImgSrc: "./objects/datastore",
          items: [
            {
              id: "number-2-1",
              caption: "number-2-1",
              leaf: true,
              startImgSrc: "objects/patterns"
            },
            {
              id: "number-2-2",
              caption: "number-2-2",
              leaf: true,
              startImgSrc: "objects/patterns"
            },
            {
              id: "number-2-3",
              caption: "number-2-3",
              disabled: true,
              leaf: true,
              startImgSrc: "objects/patterns"
            }
          ]
        },
        {
          id: "number-3",
          caption: "number-3",
          leaf: false,
          disabled: true,
          expanded: true,
          startImgSrc: "./objects/datastore",
          items: [
            {
              id: "number-3-1",
              caption: "number-3-1",
              leaf: true,
              startImgSrc: "objects/patterns"
            },
            {
              id: "number-3-2",
              caption: "number-3-2",
              disabled: true,
              leaf: true,
              startImgSrc: "objects/patterns"
            },
            {
              id: "number-3-3",
              caption: "number-3-3",
              leaf: true,
              startImgSrc: "objects/patterns"
            }
          ]
        }
      ];

      const modelLazyUpdated1 = [
        {
          id: "lazy-loaded-1",
          caption: "Lazy Loaded 1 (drag disabled)",
          leaf: true,
          startImgSrc: "objects/patterns",
          checkbox: true,
          dragDisabled: true
        },
        {
          id: "lazy-loaded-2",
          caption: "Lazy Loaded 2 (lazy, drag disabled, drop disabled)",
          leaf: false,
          lazy: true,
          startImgSrc: "objects/patterns",
          checkbox: true,
          dragDisabled: true,
          dropDisabled: true,
          toggleCheckboxes: true
        }
      ];

      const modelLazyUpdated2 = [
        {
          id: "lazy-loaded-3",
          caption: "Lazy Loaded 3 (drag disabled)",
          leaf: true,
          startImgSrc: "objects/patterns",
          checkbox: true,
          dragDisabled: true
        },
        {
          id: "lazy-loaded-4",
          caption: "Lazy Loaded 4 (drag disabled)",
          leaf: true,
          startImgSrc: "objects/patterns",
          checkbox: true,
          dragDisabled: true
        }
      ];

      const bigModel = [];

      const FIRST_LEVEL_SIZE = 10;
      const SECOND_LEVEL_SIZE = 20;
      const THIRD_LEVEL_SIZE = 20;

      for (let i = 0; i < FIRST_LEVEL_SIZE; i++) {
        bigModel.push({
          id: "item-" + i,
          caption: "item-" + i,
          lazy: true,
          leaf: false,
          startImgSrc: "objects/patterns",
          items: []
        });
      }

      const eagerLargeModel = [];

      for (let i = 0; i < FIRST_LEVEL_SIZE; i++) {
        const subEagerLargeModel = [];
        const modelId = "item-" + i;

        for (let j = 0; j < SECOND_LEVEL_SIZE; j++) {
          const subModelId = modelId + "-" + j;
          const subSubEagerLargeModel = [];

          for (let k = 0; k < THIRD_LEVEL_SIZE; k++) {
            const subSubModelId = subModelId + "-" + k;

            subSubEagerLargeModel.push({
              id: subSubModelId,
              caption: subSubModelId,
              leaf: true,
              startImgSrc: "./objects/file"
            });
          }

          subEagerLargeModel.push({
            id: subModelId,
            caption: subModelId,
            expanded: true,
            leaf: false,
            startImgSrc: "knowledge-base",
            items: subSubEagerLargeModel
          });
        }

        eagerLargeModel.push({
          id: modelId,
          caption: modelId,
          expanded: true,
          leaf: false,
          startImgSrc: "objects/patterns",
          items: subEagerLargeModel
        });
      }

      const modelMinimal = [
        {
          id: "number-2-2",
          caption: "number-2-2",
          startImgSrc: "knowledge-base"
        }
      ];

      // WA to remove extra handlers in appload event
      let appLoadFinish = false;

      window.addEventListener("appload", () => {
        if (appLoadFinish) {
          return;
        }

        console.log("Holaaa");

        appLoadFinish = true;

        const testTreeX = document.querySelector("gxg-tree-view");

        testTreeX.treeModel = kbExplorerModel;

        const multiSelectionCheckbox =
          document.getElementById("multi-selection");
        multiSelectionCheckbox.addEventListener("input", event => {
          testTreeX.multiSelection = event.target.checked;
        });

        const editableCheckbox = document.getElementById("editable");
        editableCheckbox.addEventListener("input", event => {
          testTreeX.editableItems = event.target.checked;
        });

        // Expand on click
        const expandOnClickCheckbox =
          document.getElementById("expand-on-click");
        expandOnClickCheckbox.addEventListener("input", event => {
          const checked = event.target.checked;
          testTreeX.expandOnClick = checked;
        });

        const checkAllCheckbox = document.getElementById("check-all");
        checkAllCheckbox.addEventListener("input", event => {
          const checked = event.target.checked;

          checkAllCheckbox.indeterminate = false;
          testTreeX.updateAllItemsProperties({ checked: checked });
        });

        const expandAllBtn = document.getElementById("expand-all");
        expandAllBtn.addEventListener("click", event => {
          testTreeX.updateAllItemsProperties({ expanded: true });
        });

        const collapseAllBtn = document.getElementById("collapse-all");
        collapseAllBtn.addEventListener("click", event => {
          testTreeX.updateAllItemsProperties({ expanded: false });
        });

        const dragEnabledCheckbox = document.getElementById("drag-enabled");
        dragEnabledCheckbox.addEventListener("input", event => {
          const checked = event.target.checked;

          testTreeX.dragDisabled = !checked;
        });

        const dropEnabledCheckbox = document.getElementById("drop-enabled");
        dropEnabledCheckbox.addEventListener("input", event => {
          const checked = event.target.checked;

          testTreeX.dropDisabled = !checked;
        });

        // Lines
        const linesSelect = document.getElementById("lines");
        linesSelect.addEventListener("input", event => {
          const selectedOption = event.target.value;
          testTreeX.showLines = selectedOption;
        });

        // Expandable button
        const expandableButtonSelect =
          document.getElementById("expandable-button");
        expandableButtonSelect.addEventListener("input", event => {
          const selectedOption = event.target.value;
          testTreeX.expandableButton = selectedOption;
        });

        // Drop mode
        const dropModeSelect = document.getElementById("drop-mode");
        dropModeSelect.addEventListener("input", event => {
          const selectedOption = event.target.value;
          testTreeX.dropMode = selectedOption;
        });

        const filterTypeSelect = document.getElementById("filter-type");
        filterTypeSelect.addEventListener("input", event => {
          const selectedFilterType = event.target.value;
          testTreeX.filterType = selectedFilterType;
        });

        const filterInput = document.getElementById("filter");
        filterInput.addEventListener("input", event => {
          const filter = event.target.value;
          testTreeX.filter = filter;
        });

        const camelCaseCheckbox = document.getElementById("camel-case");
        camelCaseCheckbox.addEventListener("input", event => {
          const checked = event.target.checked;

          const newOptions = { ...testTreeX.filterOptions };
          newOptions.matchCase = checked;
          testTreeX.filterOptions = newOptions;
        });

        const hideMatchesCheckbox = document.getElementById("hide-matches");
        hideMatchesCheckbox.addEventListener("input", event => {
          const checked = event.target.checked;

          const newOptions = { ...testTreeX.filterOptions };
          newOptions.hideMatchesAndShowNonMatches = checked;
          testTreeX.filterOptions = newOptions;
        });

        const loadModelBtn = document.getElementById("load-model-btn");
        loadModelBtn.addEventListener("click", () => {
          testTreeX.treeModel = model;
        });

        const updateModelBtn = document.getElementById("update-model-btn");
        updateModelBtn.addEventListener("click", () => {
          testTreeX.treeModel = updatedModel;
        });

        const updateModelAgainBtn = document.getElementById(
          "update-model-again-btn"
        );
        updateModelAgainBtn.addEventListener("click", () => {
          testTreeX.treeModel = modelTinyUpdatedAgain;
        });

        // Big model
        const updateBigModelBtn = document.getElementById(
          "update-big-model-btn"
        );
        updateBigModelBtn.addEventListener("click", () => {
          testTreeX.treeModel = bigModel;
        });

        // File system model
        const updateFileSystemBtn = document.getElementById(
          "update-file-system-btn"
        );
        updateFileSystemBtn.addEventListener("click", () => {
          testTreeX.treeModel = fileSystemModel;
        });

        const kbExplorerBtn = document.getElementById("kb-explorer-model-btn");
        kbExplorerBtn.addEventListener("click", () => {
          testTreeX.checkbox = false;
          testTreeX.checked = false;
          testTreeX.toggleCheckboxes = false;

          testTreeX.treeModel = kbExplorerModel;
        });

        const importObjectsBtn = document.getElementById(
          "import-objects-model-btn"
        );
        importObjectsBtn.addEventListener("click", () => {
          testTreeX.checkbox = true;
          testTreeX.checked = true;
          testTreeX.toggleCheckboxes = true;

          // It must be the last property updated, since with HTML the
          // properties change won't be queued to be updated in the same lifecycle
          testTreeX.treeModel = importObjectsModel;
        });

        // - - - - - - - - - - - - - -   Scroll into visible   - - - - - - - - - - - - - -
        const scrollIntoVisibleBtn = document.getElementById(
          "btn-scroll-into-visible"
        );
        const scrollIntoVisibleInput = document.getElementById(
          "input-scroll-into-visible"
        );

        const scrollIntoVisibleCheckedCheckbox = document.getElementById(
          "scroll-into-visible-checked"
        );
        const scrollIntoVisibleSelectedCheckbox = document.getElementById(
          "scroll-into-visible-selected"
        );

        scrollIntoVisibleBtn.addEventListener("click", () => {
          /** @type string */
          const itemsString = scrollIntoVisibleInput.value;

          if (!itemsString) {
            return;
          }

          const pathToScrollIntoVisible = itemsString.split(/\s*,\s*/);

          testTreeX.scrollIntoVisible(
            pathToScrollIntoVisible.length === 1
              ? pathToScrollIntoVisible[0]
              : pathToScrollIntoVisible,
            {
              checked: scrollIntoVisibleCheckedCheckbox.value === "true",
              selected: scrollIntoVisibleSelectedCheckbox.value === "true"
            }
          );
          scrollIntoVisibleInput.value = "";
        });
        // - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

        // - - - - - - - - - - - - - - Update items properties - - - - - - - - - - - - - -
        const updateItemsBtn = document.getElementById(
          "button-items-to-update"
        );
        const updateItemsInput = document.getElementById("items-to-update");

        const updateItemsCheckedCheckbox = document.getElementById(
          "update-items-properties-checked"
        );
        const updateItemsSelectedCheckbox = document.getElementById(
          "update-items-properties-selected"
        );

        updateItemsBtn.addEventListener("click", () => {
          /** @type string */
          const itemsString = updateItemsInput.value;

          if (!itemsString) {
            return;
          }

          const itemsToRemove = itemsString.split(/\s*,\s*/);

          testTreeX.updateItemsProperties(itemsToRemove, {
            checked: updateItemsCheckedCheckbox.value === "true",
            selected: updateItemsSelectedCheckbox.value === "true"
          });
          updateItemsInput.value = "";
        });
        // - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

        // Reload items
        const reloadItemsBtn = document.getElementById(
          "button-to-reload-items"
        );
        const reloadItemsInput = document.getElementById("item-id-to-reload");
        reloadItemsBtn.addEventListener("click", () => {
          testTreeX.reloadItems(
            reloadItemsInput.value,
            { downloading: true },
            { downloading: false }
          );
          reloadItemsInput.value = "";
        });

        // Remove items
        const removeItemsBtn = document.getElementById(
          "button-items-to-remove"
        );
        const removeItemsInput = document.getElementById("items-to-remove");
        removeItemsBtn.addEventListener("click", () => {
          /** @type string */
          const itemsString = removeItemsInput.value;

          if (!itemsString) {
            return;
          }

          const itemsToRemove = itemsString.split(/\s*,\s*/);

          testTreeX.removeItems(itemsToRemove);
          removeItemsInput.value = "";
        });

        const contextMenuTextBlock = document.getElementById(
          "contextmenu-textblock"
        );

        testTreeX.addEventListener("itemContextmenu", event => {
          contextMenuTextBlock.innerHTML = `+ + + + + + + Context + + + + + + +<br>
            ${event.detail.id}<br>
            level: ${event.detail.itemRef.level}<br>
            Drop Enabled: ${!event.detail.itemRef.dropDisabled}<br>
            ScreenX: ${event.detail.contextmenuEvent.screenX}<br>
            ScreenY: ${event.detail.contextmenuEvent.screenY}<br>
            `;
        });

        const openReferenceTextBlock = document.getElementById(
          "open-reference-textblock"
        );

        testTreeX.addEventListener("itemOpenReference", event => {
          openReferenceTextBlock.innerHTML = `<br>+ + + + + Open Reference + + + + +<br>
            Item ID: ${event.detail.id}<br>
            Item Leaf: ${event.detail.leaf}<br>
            Item Metadata: ${!event.detail.metadata}<br>`;
        });

        const checkedItemsTextBlock = document.getElementById(
          "checked-items-textblock"
        );

        testTreeX.addEventListener("checkedItemsChange", event => {
          if (event.detail == null) {
            checkAllCheckbox.checked = false;
            checkAllCheckbox.indeterminate = false;
            return;
          }
          const allItemsWithCheckbox = [...event.detail.values()];

          if (allItemsWithCheckbox.length === 0) {
            checkAllCheckbox.checked = false;
            checkAllCheckbox.indeterminate = false;

            checkedItemsTextBlock.innerHTML =
              "<br>+ + + + + Checked items + + + + +<br><br><br>+ + + + + Unchecked items + + + + +<br>";

            return;
          }

          const firstItemCheckedValue = allItemsWithCheckbox[0].item.checked;

          const allItemsHaveTheSameCheckedValue = allItemsWithCheckbox.every(
            treeItem => treeItem.item.checked === firstItemCheckedValue
          );

          checkAllCheckbox.checked = firstItemCheckedValue;
          checkAllCheckbox.indeterminate = !allItemsHaveTheSameCheckedValue;

          // Dummy way to check if the current treeModel is "Import Objects"
          if (testTreeX.treeModel[0]?.id === "Category") {
            allItemsWithCheckbox.forEach(itemUIModel => {
              const itemInfo = itemUIModel.item;

              // Update the amount of checked values
              if (itemInfo.leaf !== true) {
                const totalItems = itemInfo.items.length;
                // console.log(itemInfo.items);

                const totalItemsChecked = itemInfo.items.filter(
                  itemUIModel => itemUIModel.checked
                ).length;

                const newItemCaption =
                  totalItems !== totalItemsChecked
                    ? `${itemInfo.id} (${totalItemsChecked}/${totalItems})`
                    : `${itemInfo.id} (${totalItems})`;

                // Only update the item caption if needed
                if (newItemCaption !== itemInfo.caption) {
                  testTreeX.updateItemsProperties([itemInfo.id], {
                    caption: newItemCaption
                  });
                }
              }
            });
          }

          // Print checked items
          checkedItemsTextBlock.innerHTML = `<br>+ + + + + Checked items + + + + +<br>
            ${allItemsWithCheckbox
              .filter(itemUIModel => itemUIModel.item.checked)
              .map(itemUIModel => itemUIModel.item.id)
              .join("<br>")}
            <br>
            <br>+ + + + + Unchecked items + + + + +<br>
            ${allItemsWithCheckbox
              .filter(itemUIModel => !itemUIModel.item.checked)
              .map(itemUIModel => itemUIModel.item.id)
              .join("<br>")}
            `;
        });

        const selectedItemsTextBlock = document.getElementById(
          "selected-items-textblock"
        );

        testTreeX.addEventListener("selectedItemsChange", event => {
          console.log("selectedItemsChange...");

          selectedItemsTextBlock.innerHTML = `<br>+ + + + + Selected Items + + + + +<br>
            ${event.detail.map(el => el.item.id).join("<br>")}`;
        });

        /*Lazy Load Promise*/
        testTreeX.lazyLoadTreeItemsCallback = modelId =>
          new Promise((resolve, reject) => {
            let lazyModel =
              modelId === "lazy-loaded-2"
                ? modelLazyUpdated2
                : modelLazyUpdated1;

            if (modelId.startsWith("item-")) {
              lazyModel = [];

              for (let j = 0; j < SECOND_LEVEL_SIZE; j++) {
                const subModelId = modelId + "-" + j;
                const subModelItems = [];

                for (let k = 0; k < THIRD_LEVEL_SIZE; k++) {
                  subModelItems.push({
                    id: subModelId + "-" + k,
                    caption: subModelId + "-" + k,
                    leaf: true,
                    startImgSrc: "./objects/file"
                  });
                }

                lazyModel.push({
                  id: subModelId,
                  caption: subModelId,
                  expanded: true,
                  leaf: false,
                  startImgSrc: "knowledge-base",
                  items: subModelItems
                });
              }
            }

            const lazyModelResultFromDictionary =
              lazyLoadItemsDictionary[modelId];

            if (lazyModelResultFromDictionary) {
              lazyModel = lazyModelResultFromDictionary;
            }

            setTimeout(() => {
              resolve(structuredClone(lazyModel));
            }, 500); // Resolves or rejects after 500ms second
          });

        testTreeX.dropItemsCallback = () =>
          new Promise((resolve, reject) => {
            setTimeout(() => {
              resolve({ acceptDrop: true, items: modelTiny });
            }, 25); // Resolves after 25 ms
          });

        let randomSuccess = true;

        testTreeX.modifyItemCaptionCallback = (treeItemId, newCaption) =>
          new Promise((resolve, reject) => {
            const status = newCaption.trim() !== "" && randomSuccess;
            // randomSuccess = !randomSuccess;

            setTimeout(() => {
              resolve({
                success: status,
                errorMessage:
                  "Apologies, an error ocurred while changing the item caption."
              });
            }, 15); // Resolves after 15 ms
          });

        let randomAccept = true;

        testTreeX.checkDroppableZoneCallback = () =>
          new Promise((resolve, reject) => {
            const accept = randomAccept;
            // randomAccept = !randomAccept;

            setTimeout(() => {
              resolve(randomAccept);
            }, 500); // Resolves after 500 ms
          });

        /**
         * @typedef TreeXItemModel
         * @type {object}
         * @property {string} id
         * @property {string} caption
         * @property {number} order
         */
        /**
         * @param {TreeXItemModel[]} subModel
         */
        const sortItems = subModel =>
          subModel.sort((a, b) => {
            if (a.order < b.order) {
              return -1;
            }

            if (a.order > b.order) {
              return 0;
            }

            return a.caption <= b.caption ? -1 : 0;
          });

        testTreeX.sortItemsCallback = sortItems;

        // Eager large model
        // testTreeX.treeModel = eagerLargeModel;
      });
    </script>
  </body>
</html>

<!DOCTYPE html>
<html dir="ltr" lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=5.0" />
  <title>2 - SASS - Night Mode with Class</title>

  <script type="module" src="/build/gemini.esm.js"></script>
  <script nomodule src="/build/gemini.js"></script>
  <link href="/build/gemini.css" rel="stylesheet" />

  <style>
    html {
      background: var(--color-background);
      transition: background 0.2s ease-in-out;
      font-family: arial;
      color: var(--color-text);
    }

    li:hover {
      background-color: gray;
    }
    body {
      padding: 20px;
    }
    .trees-main-container {
      width: 400px;
    }
  </style>
</head>

<body>

<html dir="ltr" lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=5.0" />
  <title>2 - SASS - Night Mode with Class</title>

  <script type="module" src="/build/gemini.esm.js"></script>
  <script nomodule src="/build/gemini.js"></script>
  <link href="/build/gemini.css" rel="stylesheet" />

  <style>
    html {
      background: var(--color-background);
      transition: background 0.2s ease-in-out;
      font-family: arial;
      color: var(--color-text);
    }

    li:hover {
      background-color: gray;
    }
    body {
      padding: 20px;
    }
    .trees-main-container {
      width: 400px;
    }
  </style>
</head>

<body>

  <h3>Tree with checkboxes and left icons <span style="text-decoration: underline;">opened</span></h3>
  <gxg-tree slot="tree">
    <gxg-tree-item opened left-icon="general/knowledge-base">
      Meats
      <gxg-tree checkbox slot="tree">
        <gxg-tree-item left-icon="general/knowledge-base">
          White meats
          <gxg-tree checkbox slot="tree">
            <gxg-tree-item left-icon="general/knowledge-base">
              Chicken
            </gxg-tree-item>
            <gxg-tree-item left-icon="general/knowledge-base"> 
              Turkey
            </gxg-tree-item>
            <gxg-tree-item left-icon="general/knowledge-base">
              Duck
            </gxg-tree-item>
          </gxg-tree>
        </gxg-tree-item>
        <gxg-tree-item left-icon="general/knowledge-base">
          Red meats
          <gxg-tree checkbox slot="tree">
            <gxg-tree-item left-icon="general/knowledge-base">
              Beef
            </gxg-tree-item>
            <gxg-tree-item left-icon="general/knowledge-base"> 
              Lamb and mutton
            </gxg-tree-item>
            <gxg-tree-item left-icon="general/knowledge-base">
              Pork
            </gxg-tree-item>
          </gxg-tree>
        </gxg-tree-item>
      </gxg-tree>
    </gxg-tree-item>
    <gxg-tree-item id="fish" left-icon="general/patterns" checkbox opened download disabled right-icon="gemini-tools/download">
      Fish
    </gxg-tree-item>
    <gxg-tree-item checkbox opened left-icon="objects/module">
      Fruits
      <gxg-tree slot="tree">
        <gxg-tree-item checkbox left-icon="objects/module">
          Orange
        </gxg-tree-item>
        <gxg-tree-item checkbox left-icon="objects/module" opened>
          Banana
          <gxg-tree slot="tree">
            <gxg-tree-item left-icon="objects/module" checkbox>
              Pisang
            </gxg-tree-item>
            <gxg-tree-item checkbox left-icon="objects/module">
              Red Banana
            </gxg-tree-item>
            <gxg-tree-item left-icon="objects/module" checkbox>
              Cavendish
              <gxg-tree slot="tree">
                <gxg-tree-item left-icon="objects/module" checkbox>
                  Big
                </gxg-tree-item>
                <gxg-tree-item left-icon="objects/module" checkbox>
                  Small
                </gxg-tree-item>
                <gxg-tree-item checkbox left-icon="objects/module">
                  Mini
                </gxg-tree-item>
              </gxg-tree>
            </gxg-tree-item>
          </gxg-tree>
        </gxg-tree-item>
        <gxg-tree-item checkbox opened left-icon="objects/module">
          Strawberry
          <gxg-tree slot="tree">
            <gxg-tree-item checkbox left-icon="objects/module">
              Albion 
            </gxg-tree-item>
            <gxg-tree-item checkbox left-icon="objects/module" opened> 
              Tillamook 
            </gxg-tree-item>
            <gxg-tree-item checkbox left-icon="objects/module">
              Northeaster 
            </gxg-tree-item>
          </gxg-tree>
        </gxg-tree-item>
      </gxg-tree>
    </gxg-tree-item>
  <gxg-tree-item opened checkbox left-icon="objects/document" empty-tree>
    nuts
    <gxg-tree slot="tree">
      <gxg-tree-item opened checkbox left-icon="objects/document">
        Almonds 
        <gxg-tree slot="tree">
          <gxg-tree-item checkbox left-icon="objects/document" opened> 
            Mollar de Tarragona
          </gxg-tree-item>
          <gxg-tree-item checkbox left-icon="objects/document">
            Ferragnès 
          </gxg-tree-item>
          <gxg-tree-item checkbox left-icon="objects/document">
            Verdal 
          </gxg-tree-item>
        </gxg-tree>
      </gxg-tree-item>
      <gxg-tree-item checkbox left-icon="objects/document" opened> 
        Brazil nuts 
      </gxg-tree-item>
      <gxg-tree-item checkbox left-icon="objects/document">
        Cashews 
      </gxg-tree-item>
      <gxg-tree-item checkbox left-icon="objects/document">
        Chestnuts 
      </gxg-tree-item>
    </gxg-tree>
  </gxg-tree-item>
  </gxg-tree>

  <script>
    //DOWNLOAD SOURCE
    const fishItem = document.getElementById('fish');
    var handler = function (){
      fishItem.setAttribute("downloading", "");
      setTimeout(function(){
      const fishItems = `<gxg-tree checkbox slot="tree">
        <gxg-tree-item left-icon="general/patterns">
          Alaskan salmon
        </gxg-tree-item>
        <gxg-tree-item left-icon="general/patterns"> 
          Cod
        </gxg-tree-item>
        <gxg-tree-item left-icon="general/patterns">
          Herring
        </gxg-tree-item>
        <gxg-tree-item left-icon="general/patterns">
          Mahi-mahi
        </gxg-tree-item>
      </gxg-tree>`
      fishItem.insertAdjacentHTML( 'beforeend', fishItems );
      fishItem.setAttribute("downloaded","");
      fishItem.removeAttribute("disabled");
      fishItem.removeAttribute("download");
      fishItem.removeAttribute("downloading");
    }, 2000);
    fishItem.removeEventListener("click", handler);
    }
    fishItem.addEventListener('click', handler);

    //CHECKBOXES LOGIC
    (async () => {
      await customElements.whenDefined('gxg-tree-item');
      let gxgTreeItems = document.querySelectorAll('gxg-tree-item');
        gxgTreeItems.forEach((gxgTreeItem) =>{   
          setTimeout(function(){
            const checkBox = gxgTreeItem.shadowRoot.querySelector('gxg-form-checkbox');
            checkBox.addEventListener('click', function(){
              //Check all the child gxg-tree-items checkboxes
              const rootNodeHost = checkBox.getRootNode().host
              const rootNodeHostGxgTree = rootNodeHost.querySelector('gxg-tree');
              let rootNodeHostGxgTreeItems = null;
              if(rootNodeHostGxgTree !== null) {
                //Clicked on a not leaf
                rootNodeHostGxgTreeItems = rootNodeHostGxgTree.querySelectorAll('gxg-tree-item');
                rootNodeHostGxgTreeItems.forEach(gxgTreeItem =>{
                  setTimeout(function(){ 
                    if(rootNodeHost.checked) {
                      gxgTreeItem.checked = true;
                    } else {
                      gxgTreeItem.checked = false;
                    }
                   }, 50);
                });
              } else {
                //Clicked on a leaf
                //Get reference to parent tree
                const parentTree = rootNodeHost.parentElement;
                const parentTreeItem = parentTree.parentElement;
                let parentTreeItems = parentTree.querySelectorAll('gxg-tree-item')
                let allTreeItemsAreChecked = true;
                let allTreeItemsAreUnchecked = true;
                
                setTimeout(function(){ 
                  parentTreeItems.forEach(treeItem => {
                    if(treeItem.checked){
                      allTreeItemsAreUnchecked = false;
                    } else {
                      allTreeItemsAreChecked = false;
                    }
                  });

                  console.log('all tree items are checked', allTreeItemsAreChecked);
                  console.log('all tree items are unchecked', allTreeItemsAreUnchecked);

                  if(allTreeItemsAreUnchecked) {
                    parentTreeItem.indeterminate = false;
                    parentTreeItem.checked = false;
                  } else if (allTreeItemsAreChecked) {
                    parentTreeItem.indeterminate = false;
                    parentTreeItem.checked = true;
                  } else {
                    //indeterminate
                    parentTreeItem.indeterminate = true;
                  }

                }, 50);
              }
            })
          }, 50);
        })
    })();

  </script>

      <!--  -->


  <h3>Small tree</h3>
  <gxg-tree slot="tree">
    <gxg-tree-item left-icon="general/knowledge-base">
      Meats
    </gxg-tree-item>
    <gxg-tree-item left-icon="general/knowledge-base">
      Fish
    </gxg-tree-item>
    <gxg-tree-item left-icon="general/knowledge-base">
      Nuts
    </gxg-tree-item>
  </gxg-tree>

  <h3>Tree with checkboxes and left icons <span style="text-decoration: underline;">closed</span></h3>
  <gxg-tree slot="tree">
    <gxg-tree-item left-icon="general/knowledge-base">
      Meats
      <gxg-tree checkbox slot="tree">
        <gxg-tree-item left-icon="general/knowledge-base">
          White meats
          <gxg-tree checkbox slot="tree">
            <gxg-tree-item left-icon="general/knowledge-base">
              Chicken
            </gxg-tree-item>
            <gxg-tree-item left-icon="general/knowledge-base"> 
              Turkey
            </gxg-tree-item>
            <gxg-tree-item left-icon="general/knowledge-base">
              Duck
            </gxg-tree-item>
          </gxg-tree>
        </gxg-tree-item>
        <gxg-tree-item left-icon="general/knowledge-base">
          Red meats
          <gxg-tree checkbox slot="tree">
            <gxg-tree-item left-icon="general/knowledge-base">
              Beef
            </gxg-tree-item>
            <gxg-tree-item left-icon="general/knowledge-base"> 
              Lamb and mutton
            </gxg-tree-item>
            <gxg-tree-item left-icon="general/knowledge-base">
              Pork
            </gxg-tree-item>
          </gxg-tree>
        </gxg-tree-item>
      </gxg-tree>
    </gxg-tree-item>
    <gxg-tree-item left-icon="general/patterns">
      Fish
      <gxg-tree checkbox slot="tree">
        <gxg-tree-item left-icon="general/patterns">
          Alaskan salmon
        </gxg-tree-item>
        <gxg-tree-item left-icon="general/patterns"> 
          Cod
        </gxg-tree-item>
        <gxg-tree-item left-icon="general/patterns">
          Herring
        </gxg-tree-item>
        <gxg-tree-item left-icon="general/patterns">
          Mahi-mahi
        </gxg-tree-item>
      </gxg-tree>
    </gxg-tree-item>
    <gxg-tree-item checkbox left-icon="objects/module">
      Fruits
      <gxg-tree slot="tree">
        <gxg-tree-item checkbox left-icon="objects/module">
          Orange
        </gxg-tree-item>
        <gxg-tree-item checkbox left-icon="objects/module">
          Banana
          <gxg-tree slot="tree">
            <gxg-tree-item left-icon="objects/module" checkbox>
              Pisang
            </gxg-tree-item>
            <gxg-tree-item checkbox left-icon="objects/module">
              Red Banana
            </gxg-tree-item>
            <gxg-tree-item left-icon="objects/module" checkbox>
              Cavendish
              <gxg-tree slot="tree">
                <gxg-tree-item left-icon="objects/module" checkbox>
                  Big
                </gxg-tree-item>
                <gxg-tree-item left-icon="objects/module" checkbox>
                  Small
                </gxg-tree-item>
                <gxg-tree-item checkbox left-icon="objects/module">
                  Mini
                </gxg-tree-item>
              </gxg-tree>
            </gxg-tree-item>
          </gxg-tree>
        </gxg-tree-item>
        <gxg-tree-item checkbox left-icon="objects/module">
          Strawberry
          <gxg-tree slot="tree">
            <gxg-tree-item checkbox left-icon="objects/module">
              Albion 
            </gxg-tree-item>
            <gxg-tree-item checkbox left-icon="objects/module"> 
              Tillamook 
            </gxg-tree-item>
            <gxg-tree-item checkbox left-icon="objects/module">
              Northeaster 
            </gxg-tree-item>
          </gxg-tree>
        </gxg-tree-item>
      </gxg-tree>
    </gxg-tree-item>
  <gxg-tree-item checkbox left-icon="objects/document" empty-tree>
    nuts
    <gxg-tree slot="tree">
      <gxg-tree-item checkbox left-icon="objects/document">
        Almonds 
        <gxg-tree slot="tree">
          <gxg-tree-item checkbox left-icon="objects/document"> 
            Mollar de Tarragona
          </gxg-tree-item>
          <gxg-tree-item checkbox left-icon="objects/document">
            Ferragnès 
          </gxg-tree-item>
          <gxg-tree-item checkbox left-icon="objects/document">
            Verdal 
          </gxg-tree-item>
        </gxg-tree>
      </gxg-tree-item>
      <gxg-tree-item checkbox left-icon="objects/document"> 
        Brazil nuts 
      </gxg-tree-item>
      <gxg-tree-item checkbox left-icon="objects/document">
        Cashews 
      </gxg-tree-item>
      <gxg-tree-item checkbox left-icon="objects/document">
        Chestnuts 
      </gxg-tree-item>
    </gxg-tree>
  </gxg-tree-item>
  </gxg-tree>

</body>
</html>
